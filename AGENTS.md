# @yk-yong/react-native-barcode

Native barcode rendering library for React Native (New Architecture / Fabric).

## Package

- **npm**: `@yk-yong/react-native-barcode`
- **Version**: `0.3.0`
- **License**: MIT
- **Platforms**: iOS, Android
- **Architecture**: Fabric (New Architecture only, uses Codegen)
- **Entry**: `src/index.tsx` → built to `lib/`

## API

### Component: `ReactNativeBarcodeView`

A native view component that renders barcodes. Exported as both default and named export from `src/index.tsx`.

### Props (`ReactNativeBarcodeViewProps extends ViewProps`)

| Prop              | Type                                                  | Required | Default | Description                   |
| ----------------- | ----------------------------------------------------- | -------- | ------- | ----------------------------- |
| `value`           | `string`                                              | Yes      | —       | Data to encode in the barcode |
| `format`          | `BarcodeFormat`                                       | No       | `'qr'`  | Barcode symbology to use      |
| `foregroundColor` | `ColorValue`                                          | No       | Black   | Color of bars/modules         |
| `backgroundColor` | `ColorValue`                                          | No       | White   | Background color              |
| `onError`         | `(event: { nativeEvent: BarcodeErrorEvent }) => void` | No       | —       | Called when encoding fails    |

### Types

```typescript
type BarcodeFormat =
  | 'qr'
  | 'code128'
  | 'code39'
  | 'ean13'
  | 'ean8'
  | 'upcA'
  | 'upcE'
  | 'itf'
  | 'pdf417'
  | 'aztec'
  | 'dataMatrix';

type BarcodeErrorEvent = {
  message: string;
  code?: string; // "unsupported_format" | "encode_failed"
};
```

## Usage

```tsx
import { ReactNativeBarcodeView } from '@yk-yong/react-native-barcode';

<ReactNativeBarcodeView
  value="https://example.com"
  format="qr"
  foregroundColor="#111111"
  backgroundColor="#FFFFFF"
  style={{ width: 180, height: 180 }}
  onError={(e) => console.error(e.nativeEvent.message)}
/>;
```

## Platform Details

### iOS

- **Native framework**: CoreImage (`CIFilter` based)
- **Source**: `ios/ReactNativeBarcodeView.mm` (Objective-C++)
- **Supported formats**: `qr`, `code128`, `pdf417`, `aztec`, `dataMatrix` (5 of 11)
- **Unsupported formats** emit `onError` with code `"unsupported_format"`
- **CIFilter mapping**: QRCodeGenerator, Code128BarcodeGenerator, PDF417BarcodeGenerator, AztecCodeGenerator, DataMatrixCodeGenerator
- **Rendering**: CIFalseColor filter for colors → scaled to view bounds → UIImageView

### Android

- **Library**: ZXing (`com.google.zxing:core:3.5.3`)
- **Source**: `android/src/main/java/com/ykyong/reactnativebarcode/`
- **Key files**: `ReactNativeBarcodeView.kt` (view), `ReactNativeBarcodeViewManager.kt` (bridge), `ReactNativeBarcodePackage.kt` (registration)
- **Supported formats**: All 11 formats
- **Rendering**: `MultiFormatWriter.encode()` → pixel-by-pixel `Bitmap` creation → `ImageView`

### Format Support Matrix

| Format       | Android | iOS |
| ------------ | ------- | --- |
| `qr`         | Yes     | Yes |
| `code128`    | Yes     | Yes |
| `code39`     | Yes     | No  |
| `ean13`      | Yes     | No  |
| `ean8`       | Yes     | No  |
| `upcA`       | Yes     | No  |
| `upcE`       | Yes     | No  |
| `itf`        | Yes     | No  |
| `pdf417`     | Yes     | Yes |
| `aztec`      | Yes     | Yes |
| `dataMatrix` | Yes     | Yes |

## Project Structure

```
src/
  index.tsx                              # Public API entry, exports component + types
  ReactNativeBarcodeViewNativeComponent.ts  # Codegen spec (props, types, native component)
  react-native-codegen.d.ts             # Type declarations for codegen utilities
ios/
  ReactNativeBarcodeView.h              # Obj-C++ header
  ReactNativeBarcodeView.mm             # iOS native implementation (CoreImage)
android/
  src/main/java/com/ykyong/reactnativebarcode/
    ReactNativeBarcodeView.kt           # Android native view (ZXing)
    ReactNativeBarcodeViewManager.kt    # View manager bridge
    ReactNativeBarcodePackage.kt        # React Native package registration
example/
  src/App.tsx                           # Demo app showing QR + Code128
lib/                                    # Built output (generated by bob build)
```

## Development

```bash
yarn install          # Install dependencies
yarn typecheck        # TypeScript type checking
yarn lint             # ESLint
yarn test             # Jest tests
yarn prepare          # Build with react-native-builder-bob
yarn clean            # Remove build artifacts

# Example app
cd example
yarn ios              # Run on iOS simulator
yarn android          # Run on Android emulator
```

## Key Dependencies

- **Build**: `react-native-builder-bob` (builds JS + types to `lib/`)
- **Dev**: React 19.2.0, React Native 0.83.0, TypeScript 5.9.2
- **Android native**: ZXing 3.5.3
- **iOS native**: CoreImage (system framework, no external deps)
- **Codegen**: `codegenNativeComponent` from `react-native/Libraries/Utilities/codegenNativeComponent`
